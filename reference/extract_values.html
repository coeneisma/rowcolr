<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract Values from an Excel File Based on Row and Column Identifiers — extract_values • rowcolr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract Values from an Excel File Based on Row and Column Identifiers — extract_values"><meta name="description" content="
This function reads an Excel file and extracts structured data by
identifying row and column labels. It ensures that each row label is only
matched with the closest column label to its right and only with column
labels from the nearest preceding row that contains column headers.
You can use both regex patterns and explicit identifiers together.
If row_identifiers and/or col_identifiers are provided, they take priority over row_pattern and col_pattern.
If both explicit identifiers and regex patterns are provided, the function will first match on identifiers. Any additional matches from regex patterns will be included.

"><meta property="og:description" content="
This function reads an Excel file and extracts structured data by
identifying row and column labels. It ensures that each row label is only
matched with the closest column label to its right and only with column
labels from the nearest preceding row that contains column headers.
You can use both regex patterns and explicit identifiers together.
If row_identifiers and/or col_identifiers are provided, they take priority over row_pattern and col_pattern.
If both explicit identifiers and regex patterns are provided, the function will first match on identifiers. Any additional matches from regex patterns will be included.

"><meta property="og:image" content="https://coeneisma.github.io/rowcolr/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rowcolr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/rowcolr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/coeneisma/rowcolr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Extract Values from an Excel File Based on Row and Column Identifiers</h1>
      <small class="dont-index">Source: <a href="https://github.com/coeneisma/rowcolr/blob/main/R/extract_values.R" class="external-link"><code>R/extract_values.R</code></a></small>
      <div class="d-none name"><code>extract_values.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>This function reads an Excel file and extracts structured data by
identifying row and column labels. It ensures that each row label is only
matched with the closest column label to its right and only with column
labels from the nearest preceding row that contains column headers.</p>
<p>You can use <strong>both regex patterns and explicit identifiers together</strong>.</p><ul><li><p>If <code>row_identifiers</code> and/or <code>col_identifiers</code> are provided, they take <strong>priority</strong> over <code>row_pattern</code> and <code>col_pattern</code>.</p></li>
<li><p>If <strong>both</strong> explicit identifiers and regex patterns are provided, the function will <strong>first</strong> match on identifiers. Any additional matches from regex patterns will be included.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_values</span><span class="op">(</span></span>
<span>  <span class="va">file</span>,</span>
<span>  row_pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_pattern <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_identifiers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_identifiers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clean_description <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>Path to the Excel file.</p></dd>


<dt id="arg-row-pattern">row_pattern<a class="anchor" aria-label="anchor" href="#arg-row-pattern"></a></dt>
<dd><p>A regex pattern to identify row labels. <strong>Used only if <code>row_identifiers</code> does not fully capture all row labels</strong>. (Example: <code>".*_row$"</code>).</p></dd>


<dt id="arg-col-pattern">col_pattern<a class="anchor" aria-label="anchor" href="#arg-col-pattern"></a></dt>
<dd><p>A regex pattern to identify column labels. <strong>Used only if <code>col_identifiers</code> does not fully capture all column labels</strong>. (Example: <code>".*_col$"</code>).</p></dd>


<dt id="arg-row-identifiers">row_identifiers<a class="anchor" aria-label="anchor" href="#arg-row-identifiers"></a></dt>
<dd><p>A character vector of row label identifiers. If
provided, takes precedence over <code>row_pattern</code>, but <strong>does not disable it</strong>.</p></dd>


<dt id="arg-col-identifiers">col_identifiers<a class="anchor" aria-label="anchor" href="#arg-col-identifiers"></a></dt>
<dd><p>A character vector of column label identifiers. If
provided, takes precedence over <code>col_pattern</code>, but <strong>does not disable it</strong>.</p></dd>


<dt id="arg-clean-description">clean_description<a class="anchor" aria-label="anchor" href="#arg-clean-description"></a></dt>
<dd><p>Logical. If TRUE, removes text matching
<code>row_pattern</code> and <code>col_pattern</code> from row and column labels (default: TRUE).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble containing extracted values, including sheet name, row,
column, and description.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Extract values using regex patterns</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">extract_values</span><span class="op">(</span><span class="fu"><a href="rowcolr_example.html">rowcolr_example</a></span><span class="op">(</span><span class="st">"example.xlsx"</span><span class="op">)</span>, row_pattern <span class="op">=</span> <span class="st">".*_row$"</span>, col_pattern <span class="op">=</span> <span class="st">".*_col$"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 28 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    filename    sheet   row   col row_label col_label description data_type error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> example.xl… Bala…     2     4 name_row  value_col _           character <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> example.xl… Bala…     3     4 year_row  value_col _           numeric   <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> example.xl… Bala…     4     4 kvk_row   value_col _           numeric   <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> example.xl… Bala…     7    10 test1_row 2026_col  _           character <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> example.xl… Bala…     8    10 tes2_row  2026_col  _           character <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> example.xl… Bala…     9     4 int_fixe… 2025_col  _           numeric   <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> example.xl… Bala…    10     4 tang_fix… 2025_col  _           numeric   <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> example.xl… Bala…    11     4 fin_fixe… 2025_col  _           numeric   <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> example.xl… Bala…    13     4 tot_fixe… 2025_col  _           numeric   <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> example.xl… Bala…    16     4 stock_row 2025_col  _           numeric   <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 18 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: logical &lt;lgl&gt;, numeric &lt;dbl&gt;, date &lt;dttm&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   character &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract values using a predefined list of labels (ignoring regex)</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">extract_values</span><span class="op">(</span><span class="fu"><a href="rowcolr_example.html">rowcolr_example</a></span><span class="op">(</span><span class="st">"example.xlsx"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          row_identifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Total assets (4+9)"</span>, <span class="st">"Total equity (10+11+12)"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          col_identifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2025_col"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dataset</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   filename     sheet   row   col row_label col_label description data_type error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> example.xlsx Bala…    23     4 Total as… 2025_col  Total asse… numeric   <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> example.xlsx Bala…    31     4 Total eq… 2025_col  Total equi… numeric   <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: logical &lt;lgl&gt;, numeric &lt;dbl&gt;, date &lt;dttm&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   character &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract values using BOTH identifiers and regex</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">extract_values</span><span class="op">(</span><span class="fu"><a href="rowcolr_example.html">rowcolr_example</a></span><span class="op">(</span><span class="st">"example.xlsx"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          row_identifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Total assets (4+9)"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          row_pattern <span class="op">=</span> <span class="st">".*_row$"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were 29 warnings in `dplyr::mutate()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> The first warning was:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In argument: `closest_col_row = purrr::map_dbl(row,</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   ~max(cols$col_row[cols$col_row &lt; .x], na.rm = TRUE))`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> In group 1: `sheet_rows = "Balance"`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Caused by warning in `max()`:</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> no non-missing arguments to max; returning -Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Run `dplyr::last_dplyr_warnings()` to see the 28 remaining warnings.</span>
<span class="r-in"><span><span class="va">dataset</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 0 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 13 variables: filename &lt;chr&gt;, sheet &lt;chr&gt;, row &lt;int&gt;, col &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   row_label &lt;chr&gt;, col_label &lt;chr&gt;, description &lt;chr&gt;, data_type &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   error &lt;chr&gt;, logical &lt;lgl&gt;, numeric &lt;dbl&gt;, date &lt;dttm&gt;, character &lt;chr&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Coen Eisma.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

